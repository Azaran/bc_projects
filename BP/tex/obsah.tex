%=========================================================================
% (c) Michal Bidlo, Bohuslav Køena, 2008

\chapter{Úvod}
Ochrana a zabezpeèení soukromých a dùle¾itých informací je v dne¹ní dobì èasto se vyskytujícím
tématem na poli informaèních technologií. Je jedno jestli se bavíme o zabezpeèení dat pøi pøenosu
po síti nebo o zabezpeèení lokálnì ulo¾ených dat. Ka¾dý z nás asi zná situaci, kdy potøebuje
sdílet s nìkým informace, ale chce zajistit, ¾e je budou schopni pøeèíst pouze osoby, které jsou k
tomu urèeny.\\ 
\indent Toho lze dosáhnout ¹ifrováním informací. V dne¹ní dobì máme nezpoèet mo¾ností jak ¹ifrovat
informace. Výbìr pou¾itého ¹ifrovacího algoritmu má znaèný vliv na kvalitu zabezpeèení dat. Ov¹em
zvolení správného hesla má vliv je¹tì vìt¹í. Pokud pou¾ijete slabou ¹ifru a silné heslo ¹ance, ¾e
se k Va¹im datù dostane je o dost men¹í ne¾ kdy¾ to udìláte naopak.\\ 
\indent Èasto chceme sdílet nebo zabezpeèit více jak jeden soubor s informacemi. Obecnì se pro
spojení více souborù, rùzného typu, do jednoho celku pou¾ívají archivy. Jedním z nejroz¹íøenìj¹ích
typù souborových archivù jsou formáty .ZIP a .7z.\\
\indent V této práci se pøevá¾nì zabývám analýzou pou¾ívaných metod zabezpeèení a ¹ifrovacích
algoritmù u tìchto formátù a následnì získáváním hesel k takto zabezpeèeným souborùm. Výsledky
tìchto analýz jsou pou¾ity pro návrh roz¹iøujících modulù nástroje {\it Wrathion}. Práce se také
zabývá pøibli¾ením paralelismu a problémù s ním spojených a také úvedením do standardu a
frameworku OpenCL.

\chapter{Úvod do paralelismu}
V dne¹ní dobì se v¹echny architektury výpoèetních jednotek sna¾í poskytnout paralelní zpracování
úloh. Jedná se o cestu otevírající dveøe k znatelnému zvý¹ení výkonu takovýchto jednotek. Dnes je
ji¾ normální, ¾e máme více--jádrové procesory, které vyu¾ívají paralelismu. Ov¹em jedním z
hlavních pøedstavitelù toho trendu jsou grafické výpoèetní èipy. Tyto fakta vyús»ují v potøebu
umìt s takovýmito zaøízeními komunikovat a programovat je za úèelem vyu¾ití celého jejich
potenciálu.\\
\indent Programování aplikace vyu¾ívající paralelismù mù¾e být znaènì nároèné. Je zde i velký
rozdíl v programovacích technikách pokud chceme programovat CPU nebo GPU. Programování CPU
vychází ze za¾itých standardù co se týèe adresování pamìti apod., zatímco programování GPU se od
tìchto standardù velmi li¹í. Vytváøení obecnì pou¾itelné GPU aplikace je nároèné hlavnì z hlediska
odli¹ného pøístupù do pamìti, kde tento typ vyu¾ívá hiearchické èlenìní pamìti, a také
vyu¾ívání vektorových operací. Nejvìt¹ím problémem, ale je, ¾e v¹echny zmínìné vìci jsou je¹tì
závislé na platformì, výrobci nebo hardwaru.\\ 
\indent Takovýto vývoj obecnì pou¾itelných aplikací by byl nereálný, proto¾e bychom museli
aplikaci vyvynout ve desítkách ne--li stovkách verzí pro rùzné platformy, výrobce atd. Proto se
vyskytla potøeba vytvoøit nìjaké univerzální rozhraní. Takovýmto rozhraním je napø.: OpenCL.
\section{OpenCL\cite{Khronos:2015}\cite{AMD:2011}}
Jedná se o otevøený bezplatný standard urèený k zjednodu¹ení a zefektivnìní programování
paralelních aplikací na CPU, GPU a dal¹ích faralelních zaøízeních. OpenCL vyu¾ívá rozhraní, které
pracuje na úrovni velmi blízké samotným fyzickým souèástkám, èím¾ dosohuje vysoké efektivity. Nad
tímto rozhraním je pak vytvoøena vrstva pro paralelní výpoèty, jen¾ obsahuje pracovní prostøedky
nezávislé na platformì. Hlavní síla OpenCL je zkombinování paralelních výpoètù aplikace
se zøetìzeným rendrováním grafických prvkù.\\
Standard:
\begin{itemize}
    \item podporuje datovì i úlohovì zalo¾ené paralelní programovací modely
    \item definuje konzistentní numerické po¾adavky vycházející z IEEE 754
    \item definuje konfiguraèní profil pro pøenosná zaøízení a vestavìné systémy
    \item zaji¹»uje efektivní souèinnost s OpenGL, OpenGL SE a dal¹ími grafickými rozhraními
\end{itemize}

Nejedná se pouze o standard pro psaní paralelních aplikací, ale o i framework, který
je na tomto standardu postaven. Framework OpenCL ahrnuje programovací jazyk, rozhraní pro
programování aplikací (API), knihovny a runtimový systém pro ulehèení vývoje.
\subsection{Architektura OpenCL}
Architektura OpenCL architektury lze popsat hieararchyckým modelem následovnì:
\begin{itemize}
    \item Model platformy
    \item Model provedení
    \item Model pamìti
    \item Programovací model
\end{itemize}

\subsubsection{Model platformy}
Tento model se kládá z hostitele a jednoho nebo více OpenCL zaøízení, která je rozdìleno na jedno
nebo více výpoèetních jednotek, které jsou dále dìleny na jedno nebo vice výpoèetních prvkù, kde
u¾ se provádí samotná výpoèetní operace.\\
\indent Rozdìlení na hostitele a zaøízení vy¾aduje implementovat aplikaci pro obì èásti. Tedy
vytvoøit kód pro hostitele a pro kernel zaøízení. Vezmeme--li si jako pøíklad standardní poèítaè
tak hostitel je CPU a zaøízení je GPU, pøípadnì více GPU.\\

---------------- sem prijde obrazek platformy --------------------------
\subsubsection{Model provedení}
Jak ji¾ bylo zmínìno aplikace se dìlí na dvì èásti. Zde hovoøíme o kernelech a o hostovském
programu, pøièem¾ kernel je ten, kdo provádí výpoèty. Tato ``práce'' je provádìna pomocí
pracovních polo¾ek ({\it work-item}) jen¾ mù¾eme sdru¾ovat do pracovních skupin ({\it
work-group}).\\
\indent Hostitel má za úkol spravovat kontext aplikace a na základì nìho nastavovat prostøedí ve
kterém bude kernel provádìt operace. Prostøedí obsahuje tyto polo¾ky:
\begin{itemize}
    \item Zaøízení
    \item Objekty kernelu
    \item Objekty programu
    \item Objekty pamìti
\end{itemize}

\indent Hostitel se zaøízením komunikuje pomocí fronty pøíkazù, které se na zaøízení rozøadí podle
typu operace. Jednotlivé pøíkazy ve frontì se provádí relativnì k ostatním pøíkazùm. Poøadí
provádìní je definováno tìmito modely:
\begin{itemize}
    \item {\it In-order} -- pøíkazy se provádí a mají efekt tak jak do fronty pøisly
    \item {\it Out-of-order} -- poøadí provedení pøíkazù je omezeno pouze explicitnì uvedenými
	    synchronizaèními body nebo explicitnì definovanými závislostmi na událostech
\end{itemize}

\subsubsection{Model pamìti}
Práce s pamìtí v OpenCL se znaènì li¹í od klasického pøístupu, který známe ze standardních
aplikací urèených pro bìh pouze na CPU. Pamì»ový model OpenCL popisuje obsah, strukturu a chování
pamìti pou¾ívané v platformì vytvoøené tímto frameworkem.
\indent Pro ka¾dou aplikaci je tøeba pøesnì definovat jak budou jednotlivé pamìti v pamìti vypadat.
Model dìlíme na ètyøi èásti:
\begin{itemize}
    \item {\it Oblasti pamìti} -- definuje se kterými oblastmi pamìti hostitel a zaøízení ve
	stejném kontextu mohou pracovat
    \item {\it Objekty pamìti} -- jsou definované v OpenCL API, o správu se stará hostitel i
	zaøízení
    \item {\it Sdílenou virtuální pamì»} -- jedná se o virtuální adresový prostor pøístupný obìma
	èástem aplikace
    \item {\it Model konzistence} -- definuje pravidla pro oblasti pamìti, které jsou pou¾ívané
	více jednotkami zaráz a zaruèuje, ¾e je dodr¾eno poøadí operací s pamìtí a ¾e jsou data po
	celou dobu validní. Takté¾ definuje synchronizaci nad tìmito oblastmi.
\end{itemize}

\indent Pro nás je nejdùle¾itìj¹í pochopit jak je pamì» strukturována a jak na sebe navazují
jednotlivé oblasti. Pamì» je do oblastí rozdìlena takto:
\begin{itemize}
    \item Pamì» hostitele (RAM apod.)
    \item Pamì» zaøízení
    \begin{itemize}
	\item {\it Globální pamì»} -- oblast je pøístupná pro ètení i zápis v¹em jednotkám v
	    kontextu nezávisle na zaøízení
	\item {\it Pamì» konstant} -- pøed zahájením výpoètu je alokovaná a inicializována
	    hostitelem a v prùbìhu výpoètu se tato oblast nemìní výpoètu
	\item {\it Lokální pamì»} -- oblast je pøístupná v¹em pracovním polo¾kám ve
	    stejné pracovní skupinì
	\item {\it Soukromá pamì»} -- oblast je pøístupná pouze jedné pracovní polo¾ce 
    \end{itemize}
\end{itemize}
------- obrazek struktury pameti ------------------------
\subsubsection{Programovací model}
Tento model lze také nazvat jako OpenCL Framework. Framework se skládá ze tøech komponentù. Zde za
zmínkud stojí OpenCL kompilátor. Ten podporuje pokroèilý jazyk SPIR-V a jazyk OpenCL C. Dal¹í
jazyky mohou být podporovány nìkterými implementacemi kompilátoru.

\chapter{Nástroj Wrathion}
Jedná se o nástroj vytvoøený Janem Shmiedem v roce 2014 v rámci jeho diplomové
práci\cite{Schmied}. Nástroj byl vytvoøen pro pou¾ití v projektu {\it Moderní prostøedky pro 
boj s kybernetickou kriminalitou na Internetu nové generace, MV, VG20102015022}.\\
\section{Hlavní èásti Wrathionu}
Nástroj slou¾í ke obnovování hesel pomocí brute-force útokù na tato hesla. Nástroj má dvì hlavní
funkcionální èásti:
\subsection{Generátory hesel}
První jsou generátory hesel pro útoky. Jednáse se esenciální funkcionalitu. Bez
vygenerovaných hesel nemù¾eme na útoky vùbec myslet. V nástroji jsou momentálnì implementovány tøi
typ generátorù:
\begin{itemize}
    \item {\it Brute-force} -- postupnì generuje v¹echny mo¾né permutace ze zadaných znakù
    \item {\it Rule-based} -- velmi podobný pøedchozí variantì ov¹em umo¾òuje specifikovat rùzná
	podpùrná pravidla pro generování hesel. Napøíklad, ¾e má být první písmeno velké, druhé má
	být 'a' a ¾e poslední 2 znaky jsou èíslice. Toto umo¾òuje zù¾ení poètu permutací a tedy
	sni¾uje èas potøebný k vygenerování v¹ech jejich variant (tento typ generátoru je vyvýjen v
	rámci jiné bakaláøské  práce).
    \item {\it Unicode} -- jedná o jistou formu rule-based generátoru ov¹em v tomto pøípadì je
	pouze nastavena vstupní abeceda na v¹echny Unicode znaky a znich jsou generovány mo¾né
	permutace hesel
    \item {\it Dictionary} -- slovníkový generátor, vyu¾ívá externí soubory s èasto pou¾ívanými
	hesly
\end{itemize}

Nejèastìji pou¾ívaným generátor je brute-force, který je ov¹em výpoèetnì nároèný ov¹em vhodný
pro paralelizaci, proto je pøíhodnì implementován i jako program bì¾ící na GPU.
\subsection{Crackery}
Druhou èástí jsou samotné crackery bì¾ící na:
\begin{itemize}
    \item {\it CPU} -- zde není ¾ádný problém s generováním ani následným ovìøováním hesel

    \item {\it GPU} -- v tomto pøípadì se prvnì inicializuje OpenCL systém, vytvoøí se kontext, frontu
    pøíkazù a naèíte se a pøelo¾í se samotný program. Poté se data nahrají do GPU nebo se v ní
    pøímo vygenerují, èím¾ zvý¹íme rychlost celého programu
\end{itemize}

\subsection{Moduly}
Nástroj je navr¾en s velkým dùrazem na modularitu. V souèasné dobì obsahuje moduly pro práci s DOC
dokument, PDF dokumenty a ZIP archivù a to s podporou rùzných ¹ifrovacích algoritmù a
bezpeènostních revizí (napø. PDF revize 1-5).

\subsubsection{Modul ZIP}
V této práci nás nejvíce zajímá modul ZIP. Ten v pùvodním návrhu obsahuje pouze ¹ifrování PKZIP,
AES-128, AES-192, AES-256, co¾ zanechává prostor pro implementaci dal¹í podporovaných ¹ifrování
formátem ZIP. 

\chapter{Popis formátù .ZIP a .7z}
\section{Formát .ZIP}
Jedná se o jeden z prvních formátù souborových archivù, který podporoval kompresy dat. V roce 1989
vytvoøil Phil Katz program PKZIP v rámci nìho¾ byl pøedstaven samotnýho nový formát .ZIP.
Specifikace formátu .ZIP byla publikován pod veøejnou doménou. Tímto krokem pomohl
formátu se stát celosvìtovým otevøeným standardem\cite{PKWARE:2015}. V roce 2015 byl formát, ve své
specifikaci 6.3.3 z roku 2012, pøijat Mezinárodní orgranizací pro normalizaci (ISO) a Mezinárodní
elektrotechnickou komísí (IEC) jako¾to standard definovaný dokumentem ISO/IEC
21320-1:2015\cite{ISOIEC:2015}.\\
\indent Formát podporuje velké mno¾ství rùzný komprimaèních algoritmù: Store(bez komprese),
UnShrinking, Expanding, Imploding, Tokenizing, Deflating, Enhanced Deflating, BZIP2, LZMA, WavPack
a PPMd\cite{PKWARE:2014}.\\ 
\indent Obdobnì je to i s podporou rùzných ¹ifrovacích algoritmù:
\begin{itemize}
    \item {\it PKWARE ¹ifrování} -- prvotní ¹ifrování 
    \item {\it DES, 3DES(112-bit and 168-bit)} -- podporováno od verze 5.0 z roku 2002
    \item {\it RC2 (40-bit, 64-bit a 168-bit)} -- podporováno od verze 5.0 z roku 2002
    \item {\it RC4 (40-bit, 64-bit a 168-bit)} -- podporováno od verze 5.0 z roku 2002
    \item {\it AES (128-bit, 192-bit a 256-bit)} -- podporováno od verze 5.2 z roku 2003
\end{itemize}

\subsection{Struktura souboru}


\section{Formát .7z}
\subsection{Struktura souboru}
\section{Srovnání}


\section{Návrh modulu}

\section{Závìr}





%=========================================================================
